{% extends '/head.html' %}

{% block title %}Encrypt | Secureption{% endblock %}

{% block content %}
<div class="container my-5">
  <h2 class="text-center mb-4">🔐 RSA Encryption</h2>

  <form method="POST" action="{{ url_for('encrypt') }}" class="encrypt-form">
    <div class="form-group">
      <label for="public_key">🔑 Public Key (PEM format):</label>
      <textarea id="public_key" name="public_key" class="form-control" rows="5" required></textarea>
    </div>

    <div class="form-group mt-3">
      <label for="plaintext">📝 Enter Plaintext:</label>
      <textarea id="plaintext" name="plaintext" class="form-control" rows="4" required></textarea>
    </div>

    <div class="text-center mt-4">
      <button type="submit" class="btn btn-primary">Encrypt</button>
    </div>
  </form>

  

<script>
document.querySelector('form').addEventListener('submit', function (e) {
  const key = document.getElementById('public_key').value.trim();
  if (!key.includes('-----BEGIN PUBLIC KEY-----') || !key.includes('-----END PUBLIC KEY-----')) {
    alert("⚠️ Please paste a valid PEM-formatted RSA public key.");
    e.preventDefault();
  }
});
</script>


</script>
{% endblock %}
